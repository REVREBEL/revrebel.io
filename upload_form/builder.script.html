<script>var formBuilder,esignature="signature";function escapeParagraph(e){var t=document.createElement("textarea");return t.innerHTML=e,t.textContent.replace(/"/g,"'")}function escapeHTML(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent.replace(/&nbsp;/g," ").trim()}function cancelPreview(){startWait(),setTimeout(function(){$("div.btn-hide").hide(),$("div.content").show(),$("iframe#previewForm").hide(),$.LoadingOverlay("hide")},3e3)}function getFormJson(){for(var e=JSON.parse(formBuilder.actions.getData("json")),t=[],a={},r=0;r<e.length;r++){var o=e[r];if(delete o.className,delete o.name,o.label="paragraph"===o.type?escapeParagraph(o.label):escapeHTML(o.label),"paragraph"!==o.type){o.label=o.label.replace(/"/g,"'");var i=o.label.toLowerCase()||o.type;a[i]=a[i]||[],a[i].push(i),a[i].length>1&&(o.label=o.label+" ("+a[i].length+")")}t.push(o)}return t}function renderPreview(e){var t=$("iframe#previewForm");t.attr("srcdoc",e),setTimeout(function(){$("div.content").hide(),t.show(),$("div.btn-hide").show(),$.LoadingOverlay("hide")},3e3)}function previewForm(){startWait(),google.script.run.withSuccessHandler(renderPreview).run("preview",getFormJson())}function closeWindow(){google.script.host.close()}function showError(e){$("div.form-actions").html(e.toString())}function formSaved(){setTimeout(function(){$.LoadingOverlay("hide"),closeWindow()},3e3)}function saveForm(){startWait();try{google.script.run.withSuccessHandler(formSaved).run("save","settings",{formElems:getFormJson()})}catch(e){formSaved(),alert(e.toString())}}function startWait(){$.LoadingOverlay("show")}function stopWait(){setTimeout(function(){$.LoadingOverlay("hide")},1e3)}function showDivError(e){$("body#body").html("<div style='padding: 2em 1em; font-size: 1.2em; line-height: 1.6em'>"+e+"</div>")}function hasLocalStorage(){try{var e="modernizr";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function addonConnected(e){stopWait(),"OK"!==e&&showDivError("ERROR_MULTIPLE"===e?'Multiple Account Conflict: Please <b><a target="_blank" href="https://accounts.google.com/logout">log out</a></b> of multiple Google Accounts and try again.':e)}function initAddon(){hasLocalStorage()?(startWait(),google.script.run.withSuccessHandler(addonConnected).withFailureHandler(function(e){addonConnected("ERROR_MULTIPLE")}).run("ready",userEmail)):showDivError('<h4>Cookies are Disabled</h4><p>Please <a href="https://www.labnol.org/enable-third-party-cookies-in-google-chrome-14986" target="_blank">click here</a> for instructions on how to enable third-party cookies (<a href="https://www.youtube.com/watch?v=jFmPHPmTDeM" target="_blank">video</a>).</p><p>After the cookies are enabled, please reload the Google Sheet.</p>')}jQuery(function(e){var t={formData:formData,controlPosition:"left",controlOrder:["text","textarea","checkbox-group","radio-group","select","number","file","date",esignature,"header","paragraph"],dataType:"json",disableFields:["autocomplete","button","hidden"],subtypes:{text:["url"],header:["h4"]},editOnAdd:!0,stickyControls:{enable:!1,offset:{top:20,right:20,left:"auto"}},sortableControls:!1,showActionButtons:!0,fields:[{label:"E-Signature",attrs:{type:esignature},icon:"â„¬"}],templates:{signature:function(e){return{field:"<span></span>"}}},typeUserDisabledAttrs:{html:["required","label"],number:["step"],select:["multiple"],text:["subtype","maxlength"],paragraph:["subtype","required"],textarea:["subtype","rows","maxlength"],header:["subtype"],signature:["required"]},typeUserAttrs:{text:{regex:{label:"Validation",placeholder:"Regular Expression"}},file:{filetypes:{label:"File types",placeholder:"Allowed file types",value:"*.*"},maxcount:{label:"File Count",type:"number",value:10},maxsize:{label:"File Size",type:"number",value:100}},date:{time:{label:"Include",options:{date:"Date",datetime:"Date and Time",time:"Time"}}}},disabledAttrs:["className","access","name","placeholder","inline","other","toggle","value","subtype"],typeUserEvents:{header:{onadd:function(e){}},file:{onadd:function(t){e(".fld-filetypes",t).parent().append('<small><a href="https://digitalinspiration.com/docs/file-upload-forms/extensions" target="_blank">Click here</a> to see list of valid file types</small>'),e(".fld-maxcount",t).parent().append("<small>Maximum number of files that the user can upload</small>"),e(".fld-maxsize",t).parent().append("<small>Maximum file size (in MB) that the form can accept</small>"),e("body").hasClass("b")&&(e("div.multiple-wrap").hide(),e("div.maxcount-wrap").hide(),e("div.maxsize-wrap").html("<b>**</b> Some file upload features, like multiple uploads and higher size limits, are available with the <a target='_blank' href='https://digitalinspiration.com/GA14'>enterprise plan</a>."))}},paragraph:{onadd:function(t){var a=e(".label-wrap",t);a.find(".fld-label").attr("placeholder","Video embeds, Iframes, Images and most other HTML tags are supported in the description"),a.find("label").text("Description")}}}};(formBuilder=e(".build-wrap").formBuilder(t)).promise.then(function(t){e("li.icon-paragraph span").text("Rich HTML"),e("li.icon-header span").text("Heading"),e("li.icon-text span").text("Short Answer"),e("li.icon-date span").text("Date"),e("li.icon-textarea span").text("Paragraph"),e("li.icon-select span").text("Drop-down"),e("li.icon-checkbox-group span").text("Checkboxes"),e("li.icon-radio-group span").text("Multiple Choice");e("div.form-actions").html("<button class='btn-preview btn-show' onclick='previewForm()'>Preview</button><button class='btn-save' onclick='saveForm()'>Save</button>"),e("div.stage-wrap").prepend(),e("body").hasClass("b")&&e("ul.frmb-control>li").each(function(){e(this).data().type===esignature&&e(this).hide()})})}),initAddon();</script>